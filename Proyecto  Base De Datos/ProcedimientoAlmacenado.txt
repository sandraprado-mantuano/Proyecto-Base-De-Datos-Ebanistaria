CREATE PROCEDURE #spu_ObtenerTablasColumnas
AS
SELECT t.TABLE_SCHEMA, t.TABLE_NAME, COUNT(1) AS NUMERO_COLUMNAS
FROM INFORMATION_SCHEMA.TABLES t
INNER JOIN INFORMATION_SCHEMA.COLUMNS c
	on t.TABLE_SCHEMA = c.TABLE_SCHEMA
	and t.TABLE_NAME = c.TABLE_NAME
GROUP BY t.TABLE_SCHEMA, t.TABLE_NAME
ORDER BY 1,2

GO
EXEC #spu_ObtenerTablasColumnas
